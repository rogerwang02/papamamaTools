# 二维码生成功能配置说明

## 权限问题解决方案

如果遇到 `-604101` 权限错误，请按以下步骤配置：

### 步骤 1: 在微信开发者工具中配置

1. 打开微信开发者工具
2. 点击顶部菜单：**云开发** → **云函数**
3. 找到 `createQRCode` 云函数
4. 点击 **配置** 或 **权限设置**
5. 在 **权限** 设置中，确保开通了以下权限：
   - ✅ 调用微信开放接口
   - ✅ 生成小程序码

### 步骤 2: 在云开发控制台配置

1. 访问 [微信云开发控制台](https://console.cloud.tencent.com/tcb)
2. 选择你的云环境
3. 进入 **云函数** → **createQRCode**
4. 点击 **权限设置** 或 **配置**
5. 确保 **调用微信开放接口** 权限已开启

### 步骤 3: 检查小程序版本

- 开发版可能无法调用某些 API
- 建议使用 **体验版** 或 **正式版** 测试
- 在微信开发者工具中，点击右上角 **预览** 生成体验版二维码

### 步骤 4: 重新部署云函数

配置权限后，需要重新部署云函数：

1. 右键点击 `cloudfunctions/createQRCode` 文件夹
2. 选择 **上传并部署：云端安装依赖（不上传 node_modules）**
3. 等待部署完成

## 如果权限问题仍无法解决

如果以上步骤都无法解决权限问题，可以考虑：

### 替代方案 A: 使用普通二维码（降级方案）

使用第三方库生成包含页面链接的二维码，用户扫码后手动打开小程序。

### 替代方案 B: 使用小程序链接

生成一个包含小程序页面路径的链接，用户点击链接跳转到小程序。

